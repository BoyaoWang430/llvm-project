; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc -mtriple=riscv32 -mattr=+experimental-zibi -verify-machineinstrs < %s \
; RUN:     | FileCheck -check-prefix=ZIBI %s
; RUN: llc -mtriple=riscv64 -mattr=+experimental-zibi -verify-machineinstrs < %s \
; RUN:     | FileCheck -check-prefix=ZIBI %s

define void @test_bne_neg(ptr %b) nounwind {
; ZIBI-LABEL: test_bne_neg:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    bnei a1, -1, .LBB0_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB0_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp ne i32 %val1, -1
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}

define void @test_beq_neg(ptr %b) nounwind {
; ZIBI-LABEL: test_beq_neg:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    beqi a1, -1, .LBB1_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB1_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp eq i32 %val1, -1
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}

define void @test_bne_zero(ptr %b) nounwind {
; ZIBI-LABEL: test_bne_zero:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    bnez a1, .LBB2_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB2_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp ne i32 %val1, 0
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}

define void @test_beq_zero(ptr %b) nounwind {
; ZIBI-LABEL: test_beq_zero:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    beqz a1, .LBB3_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB3_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp eq i32 %val1, 0
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}

define void @test_bne_1(ptr %b) nounwind {
; ZIBI-LABEL: test_bne_1:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    bnei a1, 1, .LBB4_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB4_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp ne i32 %val1, 1
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}

define void @test_beq_1(ptr %b) nounwind {
; ZIBI-LABEL: test_beq_1:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    beqi a1, 1, .LBB5_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB5_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp eq i32 %val1, 1
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}

define void @test_bne_31(ptr %b) nounwind {
; ZIBI-LABEL: test_bne_31:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    bnei a1, 31, .LBB6_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB6_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp ne i32 %val1, 31
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}

define void @test_beq_31(ptr %b) nounwind {
; ZIBI-LABEL: test_beq_31:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    beqi a1, 1, .LBB7_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB7_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp eq i32 %val1, 1
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}

define void @test_bne_32(ptr %b) nounwind {
; ZIBI-LABEL: test_bne_32:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    li a2, 32
; ZIBI-NEXT:    bne a1, a2, .LBB8_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB8_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp ne i32 %val1, 32
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}

define void @test_beq_32(ptr %b) nounwind {
; ZIBI-LABEL: test_beq_32:
; ZIBI:       # %bb.0:
; ZIBI-NEXT:    lw a1, 0(a0)
; ZIBI-NEXT:    li a2, 32
; ZIBI-NEXT:    beq a1, a2, .LBB9_2
; ZIBI-NEXT:  # %bb.1: # %test2
; ZIBI-NEXT:    lw zero, 0(a0)
; ZIBI-NEXT:  .LBB9_2: # %end
; ZIBI-NEXT:    ret
  %val1 = load volatile i32, ptr %b
  %tst1 = icmp eq i32 %val1, 32
  br i1 %tst1, label %end, label %test2, !prof !0
test2:
  %val2 = load volatile i32, ptr %b
  br label %end
end:
  ret void
}
!0 = !{!"branch_weights", i32 1, i32 99}
